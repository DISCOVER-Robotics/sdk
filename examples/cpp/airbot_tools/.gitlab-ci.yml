variables:
  NPROC: 16

airbot-tools:
  stage: build
  image: registry.qiuzhi.tech/airbot-play/arm-control:develop
  script:
    - sed -i 's|http://archive.ubuntu.com/|http://mirrors.tuna.tsinghua.edu.cn/|' /etc/apt/sources.list
    - apt update && DEBIAN_FRONTEND=noninteractive TZ=Asia/Shanghai apt install -y libopencv-*
    - cd examples/cpp/airbot_tools && mkdir build && cd build && cmake .. && make -j $NPROC && cpack -G DEB
    - mkdir $CI_PROJECT_DIR/airbot-tools && mv ../*.deb $CI_PROJECT_DIR
  artifacts:
    paths:
      - "$CI_PROJECT_DIR/airbot-tools*.deb"
    expire_in: 1 week